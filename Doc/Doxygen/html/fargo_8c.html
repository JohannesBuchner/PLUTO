<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>PLUTO: /Users/mignone/PLUTO/Src/Fargo/fargo.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">PLUTO
   &#160;<span id="projectnumber">4.2</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_413f4e031a85da0d68269c6fd2f76e1c.html">Src</a></li><li class="navelem"><a class="el" href="dir_f18081722165c4d226a621fa2c6b91b1.html">Fargo</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">fargo.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Solves the linear transport step of the FARGO-MHD algorithm.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="pluto_8h_source.html">pluto.h</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:afb9293694df8171deefda0ec7576d656"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fargo_8c.html#afb9293694df8171deefda0ec7576d656">FARGO_Flux</a> (double *, double *, double)</td></tr>
<tr class="separator:afb9293694df8171deefda0ec7576d656"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87eee059b057773a9f52bf5804012789"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fargo_8c.html#a87eee059b057773a9f52bf5804012789">FARGO_ParallelExchange</a> (Data_Arr U, Data_Arr Us, double ***rbl[], <a class="el" href="struct_r_box.html">RBox</a> *, double ***rbu[], <a class="el" href="struct_r_box.html">RBox</a> *, <a class="el" href="struct_grid.html">Grid</a> *grid)</td></tr>
<tr class="separator:a87eee059b057773a9f52bf5804012789"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59308db9be395042750b857ef8cdbd92"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fargo_8c.html#a59308db9be395042750b857ef8cdbd92">FARGO_ShiftSolution</a> (Data_Arr U, Data_Arr Us, <a class="el" href="struct_grid.html">Grid</a> *grid)</td></tr>
<tr class="separator:a59308db9be395042750b857ef8cdbd92"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Implements a uniform shift of the conservative fluid variables in the direction of orbital motion which is assumed to be <img class="formulaInl" alt="$ x_2=y,\phi$" src="form_82.png"/> (for Cartesian or polar coordinates) or <img class="formulaInl" alt="$ x_3 = \phi$" src="form_83.png"/> (for spherical coordinates). The shift is converted into an integer part "m" and a fractional remainder "eps".<br />
 Parallelization is performed by adding extra data layers above and below the current data set so as to enlarge the required computational stencil in the orbital direction. The additional buffers are received from the processors lying, respectively, below and above and their size changes dynamically from one step to the next.</p>
<p><b>Reference</b> </p><ul>
<li>"A conservative orbital advection scheme for simulations 
     of magnetized shear flows with the PLUTO code"<br />
 Mignone et al, A&amp;A (2012) 545, A152 (&ndash;&gt; Section 2.4)</li>
</ul>
<dl class="section author"><dt>Author</dt><dd>A. Mignone (<a href="#" onclick="location.href='mai'+'lto:'+'mig'+'no'+'ne@'+'ph'+'.un'+'it'+'o.i'+'t'; return false;">migno<span style="display: none;">.nosp@m.</span>ne@p<span style="display: none;">.nosp@m.</span>h.uni<span style="display: none;">.nosp@m.</span>to.i<span style="display: none;">.nosp@m.</span>t</a>)<br />
 G. Muscianisi (<a href="#" onclick="location.href='mai'+'lto:'+'g.m'+'us'+'cia'+'ni'+'si@'+'ci'+'nec'+'a.'+'it'; return false;">g.mus<span style="display: none;">.nosp@m.</span>cian<span style="display: none;">.nosp@m.</span>isi@c<span style="display: none;">.nosp@m.</span>inec<span style="display: none;">.nosp@m.</span>a.it</a>) </dd></dl>
<dl class="section date"><dt>Date</dt><dd>Aug 23, 2015 </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="afb9293694df8171deefda0ec7576d656"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void FARGO_Flux </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>flx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>eps</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Compute the transport flux corresponding to a fractional increment eps.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">q</td><td>1D array of a conserved quantity </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">flx</td><td>the conservative flux </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">eps</td><td>the fractional increment</td></tr>
  </table>
  </dd>
</dl>
<p>The following MAPLE script may be used to check the correctness of implementation </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;restart;</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;P0 := 3/2*q[i] - (q[p]+q[m])/4;</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;P1 := q[p] - q[m];</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;P2 := 3*(q[p] - 2*q[i] + q[m]);</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;FS[p] := P0 + P1/2*(1 - epsilon) + P2*(1/4 - epsilon/2 + epsilon^2/3);</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;FS[m] := P0 - P1/2*(1 - epsilon) + P2*(1/4 - epsilon/2 + epsilon^2/3);</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;dq  := q[p] - q[m];</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;d2q := q[p] - 2*q[i] + q[m];</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;FF[p] := q[p] - epsilon/2*(dq + d2q*(3 - 2*epsilon));</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;FF[m] := q[m] + epsilon/2*(dq - d2q*(3 - 2*epsilon));</div>
</div><!-- fragment --> 
</div>
</div>
<a class="anchor" id="a87eee059b057773a9f52bf5804012789"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void FARGO_ParallelExchange </td>
          <td>(</td>
          <td class="paramtype">Data_Arr&#160;</td>
          <td class="paramname"><em>U</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Data_Arr&#160;</td>
          <td class="paramname"><em>Us</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double ***&#160;</td>
          <td class="paramname"><em>recv_buf_lower</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_r_box.html">RBox</a> *&#160;</td>
          <td class="paramname"><em>lbox</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double ***&#160;</td>
          <td class="paramname"><em>recv_buf_upper</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_r_box.html">RBox</a> *&#160;</td>
          <td class="paramname"><em>ubox</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_grid.html">Grid</a> *&#160;</td>
          <td class="paramname"><em>grid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Exchange data value between adjacent processors lying in the the same direction (x2 for CARTESIAN/POLAR or x3 for SPHERICAL) Values will be stored inside recv_buf_lower &amp; recv_buf_upper.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">U</td><td>a 3D array of conserved, zone-centered values </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">Us</td><td>a 3D array of staggered magnetic fields </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">recv_buf_lower</td><td>buffer array received from the processor ahead </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">recv_buf_upper</td><td>buffer array received from the processor behind </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ubox</td><td>pointer to <a class="el" href="struct_r_box.html">RBox</a> structure defining the index range of the upper data layer </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lbox</td><td>pointer to <a class="el" href="struct_r_box.html">RBox</a> structure defining the index range of the lower data layer </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">grid</td><td>pointer to <a class="el" href="struct_grid.html">Grid</a> structure;</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>This function has no return value. </dd></dl>

</div>
</div>
<a class="anchor" id="a59308db9be395042750b857ef8cdbd92"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FARGO_ShiftSolution </td>
          <td>(</td>
          <td class="paramtype">Data_Arr&#160;</td>
          <td class="paramname"><em>U</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Data_Arr&#160;</td>
          <td class="paramname"><em>Us</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_grid.html">Grid</a> *&#160;</td>
          <td class="paramname"><em>grid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Shifts conserved variables in the orbital direction.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">U</td><td>a 3D array of conserved, zone-centered values </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">Us</td><td>a 3D array of staggered magnetic fields </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">grid</td><td>pointer to <a class="el" href="struct_grid.html">Grid</a> structure;</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>This function has no return value. </dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000002">Todo:</a></b></dt><dd>Optimization: avoid using too many if statement like on nproc_s &gt; 1 or == 1 </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Aug 31 2015 12:33:06 for PLUTO by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.8
</small></address>
</body>
</html>
