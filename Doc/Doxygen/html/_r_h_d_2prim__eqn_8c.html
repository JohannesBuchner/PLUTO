<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PLUTO: /Users/mignone/PLUTO/Src/RHD/prim_eqn.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">PLUTO
   &#160;<span id="projectnumber">4.3</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_413f4e031a85da0d68269c6fd2f76e1c.html">Src</a></li><li class="navelem"><a class="el" href="dir_7b05762d6e3c6ba660a688454579b2f1.html">RHD</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">prim_eqn.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Compute the right hand side of the relativistic hydro (RHD) equations in primitive form.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="pluto_8h_source.html">pluto.h</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a26702fac9be83b23ddca296e1c3fed03"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_r_h_d_2prim__eqn_8c.html#a26702fac9be83b23ddca296e1c3fed03">PrimRHS</a> (double *w, double *dw, double cs2, double h, double *Adw)</td></tr>
<tr class="separator:a26702fac9be83b23ddca296e1c3fed03"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f2407ef2a07d31d8deb5ab21e3da1f8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_r_h_d_2prim__eqn_8c.html#a9f2407ef2a07d31d8deb5ab21e3da1f8">PrimSource</a> (const <a class="el" href="struct_state.html">State</a> *state, double **src, int beg, int end, <a class="el" href="struct_grid.html">Grid</a> *grid)</td></tr>
<tr class="separator:a9f2407ef2a07d31d8deb5ab21e3da1f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Implements the right hand side of the quasi-linear form of the relativistic hydro equations. In 1D this may be written as </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \partial_t{\mathbf{V}} = - A\cdot\partial_x\mathbf{V} + \mathbf{S} \]" src="form_112.png"/>
</p>
<p> where <img class="formulaInl" alt="$ A $" src="form_113.png"/> is the matrix of the primitive form of the equations, <img class="formulaInl" alt="$ S $" src="form_114.png"/> is the source term.</p>
<p><b>Reference:</b> </p><ul>
<li>"The Piecewise Parabolic Method for  Multidimensional Relativistic 
     Fluid Dynamics", Mignone, Plewa and Bodo, ApJS (2005) 160,199.</li>
</ul>
<p>The function <a class="el" href="_h_d_2prim__eqn_8c.html#aca4116e364d50622e96a380a2fdf7995">PrimRHS()</a> implements the first term while <a class="el" href="_h_d_2prim__eqn_8c.html#a9f2407ef2a07d31d8deb5ab21e3da1f8">PrimSource()</a> implements the source term part.</p>
<dl class="section author"><dt>Author</dt><dd>A. Mignone (<a href="#" onclick="location.href='mai'+'lto:'+'mig'+'no'+'ne@'+'ph'+'.un'+'it'+'o.i'+'t'; return false;">migno<span style="display: none;">.nosp@m.</span>ne@p<span style="display: none;">.nosp@m.</span>h.uni<span style="display: none;">.nosp@m.</span>to.i<span style="display: none;">.nosp@m.</span>t</a>) </dd></dl>
<dl class="section date"><dt>Date</dt><dd>March 16, 2018 </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a26702fac9be83b23ddca296e1c3fed03"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a26702fac9be83b23ddca296e1c3fed03">&#9670;&nbsp;</a></span>PrimRHS()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PrimRHS </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>dw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>cs2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>Adw</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute the matrix-vector multiplication <img class="formulaInl" alt="$ A(\mathbf{v})\cdot \Delta\mathbf{v} $" src="form_115.png"/> where <code>A</code> is the matrix of the quasi-linear form of the RHD equations.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">w</td><td>vector of primitive variables; </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dw</td><td>limited (linear) slopes; </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cs2</td><td>local sound speed; </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">h</td><td>local enthalpy; </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">Adw</td><td>matrix-vector product.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd></dd></dl>
<dl class="section return"><dt>Returns</dt><dd>This function has no return value. </dd></dl>
<dl class="section note"><dt>Note</dt><dd>In the 7-wave and 8-wave formulations we use the the same matrix being decomposed into right and left eigenvectors during the Characteristic Tracing step. Note, however, that it DOES NOT include two additional terms (-vy*dV[BX] for By, -vz*dv[BX] for Bz) that are needed in the <h2>7-wave form and are added using source terms. </h2>
</dd></dl>

</div>
</div>
<a id="a9f2407ef2a07d31d8deb5ab21e3da1f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9f2407ef2a07d31d8deb5ab21e3da1f8">&#9670;&nbsp;</a></span>PrimSource()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PrimSource </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_state.html">State</a> *&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>beg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_grid.html">Grid</a> *&#160;</td>
          <td class="paramname"><em>grid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute source terms of the RHD equations in primitive variables.</p>
<ul>
<li>Geometrical sources;</li>
<li>Gravity;</li>
</ul>
<p>The rationale for choosing during which sweep a particular source term has to be incorporated should match the same criterion used during the conservative update. For instance, in polar or cylindrical coordinates, curvilinear source terms are included during the radial sweep only.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">state</td><td>pointer to a <a class="el" href="struct_sweep.html">Sweep</a> structure </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">src</td><td>array of source terms </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">beg</td><td>initial index of computation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">end</td><td>final index of computation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">grid</td><td>pointer to a <a class="el" href="struct_grid.html">Grid</a> structure </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Jun 7 2018 18:33:50 for PLUTO by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
