<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PLUTO: /Users/mignone/PLUTO/Src/Particles/particles_cr_feedback.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">PLUTO
   &#160;<span id="projectnumber">4.3</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_413f4e031a85da0d68269c6fd2f76e1c.html">Src</a></li><li class="navelem"><a class="el" href="dir_9206b596ebf640a5bddb105d741e15ea.html">Particles</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">particles_cr_feedback.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>File containing functions for feedback from CR to the fluid.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="pluto_8h_source.html">pluto.h</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ab2ec9790fd367bce9b2ad33bbd9c8692"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="particles__cr__feedback_8c.html#ab2ec9790fd367bce9b2ad33bbd9c8692">Particles_CR_ConservativeFeedback</a> (Data_Arr U, Data_Arr Fcr, double dt, <a class="el" href="struct_r_box.html">RBox</a> *box)</td></tr>
<tr class="separator:ab2ec9790fd367bce9b2ad33bbd9c8692"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f1ca28591574203fd95e3d854cb1576"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="particles__cr__feedback_8c.html#a8f1ca28591574203fd95e3d854cb1576">Particles_CR_Flux</a> (const <a class="el" href="struct_state.html">State</a> *state, int beg, int end)</td></tr>
<tr class="separator:a8f1ca28591574203fd95e3d854cb1576"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18e30e56cb437719172271e7f932c2dd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="particles__cr__feedback_8c.html#a18e30e56cb437719172271e7f932c2dd">Particles_CR_States1DCopy</a> (const <a class="el" href="struct_data.html">Data</a> *d, const <a class="el" href="struct_sweep.html">Sweep</a> *sweep, int beg, int end)</td></tr>
<tr class="separator:a18e30e56cb437719172271e7f932c2dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4cc104b5fb39303b6b3bf202946aabb4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="particles__cr__feedback_8c.html#a4cc104b5fb39303b6b3bf202946aabb4">Particles_CR_StatesSource</a> (const <a class="el" href="struct_sweep.html">Sweep</a> *sweep, double dt, int beg, int end, <a class="el" href="struct_grid.html">Grid</a> *grid)</td></tr>
<tr class="separator:a4cc104b5fb39303b6b3bf202946aabb4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28934d9e4474fc284ddf4bff2720f5ad"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="particles__cr__feedback_8c.html#a28934d9e4474fc284ddf4bff2720f5ad">Particles_CR_StatesSourceOld</a> (const <a class="el" href="struct_sweep.html">Sweep</a> *sweep, double dt, int beg, int end, <a class="el" href="struct_grid.html">Grid</a> *grid)</td></tr>
<tr class="separator:a28934d9e4474fc284ddf4bff2720f5ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><dl class="section author"><dt>Authors</dt><dd>A. Mignone (<a href="#" onclick="location.href='mai'+'lto:'+'mig'+'no'+'ne@'+'ph'+'.un'+'it'+'o.i'+'t'; return false;">migno<span style="display: none;">.nosp@m.</span>ne@p<span style="display: none;">.nosp@m.</span>h.uni<span style="display: none;">.nosp@m.</span>to.i<span style="display: none;">.nosp@m.</span>t</a>)<br />
 <b>References</b> <ul>
<li>"MAGNETOHYDRODYNAMIC-PARTICLE-IN-CELL METHOD FOR COUPLING COSMIC RAYS 
     WITH A THERMAL PLASMA: APPLICATION TO NON-RELATIVISTIC SHOCKS"<br />
 Bai et al., ApJ (2015) 809, 55</li>
</ul>
</dd></dl>
<dl class="section date"><dt>Date</dt><dd>June 15, 2017 </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="ab2ec9790fd367bce9b2ad33bbd9c8692"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab2ec9790fd367bce9b2ad33bbd9c8692">&#9670;&nbsp;</a></span>Particles_CR_ConservativeFeedback()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Particles_CR_ConservativeFeedback </td>
          <td>(</td>
          <td class="paramtype">Data_Arr&#160;</td>
          <td class="paramname"><em>U</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Data_Arr&#160;</td>
          <td class="paramname"><em>Fcr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_r_box.html">RBox</a> *&#160;</td>
          <td class="paramname"><em>box</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Add source term to the right hand side of the conservative MHD equations.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">U</td><td>An array of conserved quantities, U[k][j][i][nv] </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Fcr</td><td>An array containing the CR feedback, Fcr[4][k][j][i] </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dt</td><td>The time step increment </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">box</td><td>A pointer to a <a class="el" href="struct_r_box.html">RBox</a> structure. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a8f1ca28591574203fd95e3d854cb1576"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f1ca28591574203fd95e3d854cb1576">&#9670;&nbsp;</a></span>Particles_CR_Flux()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Particles_CR_Flux </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_state.html">State</a> *&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>beg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>end</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Add CR flux contribution to MHD fluxes. On input, it requires <code>state-&gt;Fcr</code> to be already computed. On output, it returns <code>state-&gt;fluxCR</code>. </p>

</div>
</div>
<a id="a18e30e56cb437719172271e7f932c2dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a18e30e56cb437719172271e7f932c2dd">&#9670;&nbsp;</a></span>Particles_CR_States1DCopy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Particles_CR_States1DCopy </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_data.html">Data</a> *&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_sweep.html">Sweep</a> *&#160;</td>
          <td class="paramname"><em>sweep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>beg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>end</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Load Fcr from 3D data into 1D state structures. This is needed later to compute the flux (Particles_CR_Flux). </p>

</div>
</div>
<a id="a4cc104b5fb39303b6b3bf202946aabb4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4cc104b5fb39303b6b3bf202946aabb4">&#9670;&nbsp;</a></span>Particles_CR_StatesSource()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Particles_CR_StatesSource </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_sweep.html">Sweep</a> *&#160;</td>
          <td class="paramname"><em>sweep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>beg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_grid.html">Grid</a> *&#160;</td>
          <td class="paramname"><em>grid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Add CR flux-difference and source term contributions to L/R primitive states during the predictor step of CTU algorithm. Note that, although the update should be done in conservative variables, we choose to directly update primitive variables by performing, in place, a conservative-to-primitive recovery so that: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \left\{\begin{array}{lcl} \vec{m}_\pm &amp;\leftarrow&amp; \DS \vec{m}_\pm - \frac{\Delta t}{2}\vec{F}_{CR} \\ \noalign{\medskip} \vec{B}_\pm &amp;\leftarrow&amp; \DS \vec{B}_\pm + \frac{\Delta t}{2}\nabla_x\times \left(\frac{\vec{F}_{CR}}{q_g}\right) \\ \noalign{\medskip} {\cal E}_\pm &amp;\leftarrow&amp; \DS {\cal E}_\pm - \frac{\Delta t}{2}\nabla_x\cdot \left(\frac{\vec{F}_{CR}\times\vec{B}}{q_g} + \vec{F}_{CR}\cdot\vec{v}\right) \end{array}\right. \quad\Longrightarrow\quad \left\{\begin{array}{lcl} \vec{v}_1 &amp;=&amp; \vec{v}_0 + \Delta\vec{v} \\ \noalign{\medskip} \vec{B}_1 &amp;=&amp; \vec{B}_0 + \Delta\vec{B} \\ \noalign{\medskip} (\rho e)_1 &amp;=&amp; \DS (\rho e)_0 + \frac{\rho}{2}(\vec{v}_0^2 - \vec{v}_1^2) + \frac{1}{2}\left(\vec{B}_0^2-\vec{B}_1^2\right) + \Delta {\cal E}; \end{array}\right. \]" src="form_235.png"/>
</p>
<p>Note that curl and divergence operators are discretized using finite differences of <code>fluxCR</code> computed in <a class="el" href="particles__cr__feedback_8c.html#a8f1ca28591574203fd95e3d854cb1576">Particles_CR_Flux()</a>.</p>
<p>This step is done only for the primitive Hancock / Char. Trac. schemes since these are carried out in primitive variables. This step is not needed for the conservative Hancock scheme since these terms are included during the predictor.</p>
<p>For source terms not involving derivatives, we include <em>ALL</em> of the components here since no other partcles-related source term will be added during the transverse predictors. For source terms involving derivatives, we include only the normal components since the transverse predictor will add the other components through Riemann solver. </p>

</div>
</div>
<a id="a28934d9e4474fc284ddf4bff2720f5ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a28934d9e4474fc284ddf4bff2720f5ad">&#9670;&nbsp;</a></span>Particles_CR_StatesSourceOld()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Particles_CR_StatesSourceOld </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_sweep.html">Sweep</a> *&#160;</td>
          <td class="paramname"><em>sweep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>beg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_grid.html">Grid</a> *&#160;</td>
          <td class="paramname"><em>grid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Add CR flux-difference and source term contributions to L/R conservative states during the predictor step of CTU algorithm.</p>
<p>This step is done only for the primitive Hancock / Char. Trac. schemes since these are carried out in primitive variables. This step is not needed for the conservative Hancock scheme since these terms are included during the predictor.</p>
<p>Note that, unlike gravity, we include <em>ALL</em> components of the force here since no other partcles-related source term will be added during the transverse predictors. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Jun 7 2018 18:33:51 for PLUTO by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
