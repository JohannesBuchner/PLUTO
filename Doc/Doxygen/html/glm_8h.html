<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>PLUTO: /Users/mignone/PLUTO/Src/MHD/GLM/glm.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">PLUTO
   &#160;<span id="projectnumber">4.2</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_413f4e031a85da0d68269c6fd2f76e1c.html">Src</a></li><li class="navelem"><a class="el" href="dir_393faf7c97aebfe9abb0723b81bbf748.html">MHD</a></li><li class="navelem"><a class="el" href="dir_de2fe2cc11c7c1947b35cf76d77fee54.html">GLM</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">glm.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Header file for GLM Divergence Cleaning.  
<a href="#details">More...</a></p>

<p><a href="glm_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:aa17a379ad5696bad2b2b7147a38f2be7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="glm_8h.html#aa17a379ad5696bad2b2b7147a38f2be7">GLM_ALPHA</a>&#160;&#160;&#160;0.1</td></tr>
<tr class="separator:aa17a379ad5696bad2b2b7147a38f2be7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a0b29ec4a2a3a27454614ba72080bd7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="glm_8h.html#a4a0b29ec4a2a3a27454614ba72080bd7">GLM_EXTENDED</a>&#160;&#160;&#160;NO</td></tr>
<tr class="separator:a4a0b29ec4a2a3a27454614ba72080bd7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a1e39b2e3fc2139dbef1fd1bc297e1d6b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="glm_8h.html#a1e39b2e3fc2139dbef1fd1bc297e1d6b">GLM_Solve</a> (const <a class="el" href="struct_state__1_d.html">State_1D</a> *, double **, double **, int, int, <a class="el" href="struct_grid.html">Grid</a> *)</td></tr>
<tr class="separator:a1e39b2e3fc2139dbef1fd1bc297e1d6b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50b706a077ad71dba043b93d789d4376"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="glm_8h.html#a50b706a077ad71dba043b93d789d4376">GLM_Init</a> (const <a class="el" href="struct_data.html">Data</a> *, const <a class="el" href="struct_time___step.html">Time_Step</a> *, <a class="el" href="struct_grid.html">Grid</a> *)</td></tr>
<tr class="separator:a50b706a077ad71dba043b93d789d4376"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a793d2e1cde4e678c8fe569a03bda5484"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="glm_8h.html#a793d2e1cde4e678c8fe569a03bda5484">GLM_Source</a> (const Data_Arr, double, <a class="el" href="struct_grid.html">Grid</a> *)</td></tr>
<tr class="separator:a793d2e1cde4e678c8fe569a03bda5484"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04198e1816b86c3752670bb99635033f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="glm_8h.html#a04198e1816b86c3752670bb99635033f">GLM_ExtendedSource</a> (const <a class="el" href="struct_state__1_d.html">State_1D</a> *, double, int, int, <a class="el" href="struct_grid.html">Grid</a> *)</td></tr>
<tr class="separator:a04198e1816b86c3752670bb99635033f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a7f176850b7d2e1bc4d2f50b3c52bff47"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="glm_8h.html#a7f176850b7d2e1bc4d2f50b3c52bff47">glm_ch</a></td></tr>
<tr class="separator:a7f176850b7d2e1bc4d2f50b3c52bff47"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Contains function prototypes and global variable declaration for the GLM formulation to control the divergence-free condition of magnetic field.</p>
<dl class="section author"><dt>Authors</dt><dd>A. Mignone (<a href="#" onclick="location.href='mai'+'lto:'+'mig'+'no'+'ne@'+'ph'+'.un'+'it'+'o.i'+'t'; return false;">migno<span style="display: none;">.nosp@m.</span>ne@p<span style="display: none;">.nosp@m.</span>h.uni<span style="display: none;">.nosp@m.</span>to.i<span style="display: none;">.nosp@m.</span>t</a>)<br />
 P. Tzeferacos (<a href="#" onclick="location.href='mai'+'lto:'+'pet'+'ro'+'s.t'+'ze'+'fer'+'ac'+'os@'+'ph'+'.un'+'it'+'o.i'+'t'; return false;">petro<span style="display: none;">.nosp@m.</span>s.tz<span style="display: none;">.nosp@m.</span>efera<span style="display: none;">.nosp@m.</span>cos@<span style="display: none;">.nosp@m.</span>ph.un<span style="display: none;">.nosp@m.</span>ito.<span style="display: none;">.nosp@m.</span>it</a>) </dd></dl>
<dl class="section date"><dt>Date</dt><dd>July 24, 2015</dd></dl>
<p><b>References</b> </p><ul>
<li>"A Second-order unsplit Godunov scheme for cell-centered MHD:
      The CTU-GLM scheme"<br />
 Mignone &amp; Tzeferacos, JCP (2010) 229, 2117</li>
<li>"High-order conservative finite difference GLM-MHD scheme for
      cell-centered MHD"<br />
 Mignone, Tzeferacos &amp; Bodo, JCP (2010) 229, 5896 </li>
</ul>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="aa17a379ad5696bad2b2b7147a38f2be7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define GLM_ALPHA&#160;&#160;&#160;0.1</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Sets the damping rate of monopoles. </p>

</div>
</div>
<a class="anchor" id="a4a0b29ec4a2a3a27454614ba72080bd7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define GLM_EXTENDED&#160;&#160;&#160;NO</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The GLM_EXTENDED macro may be turned to YES to enable the extended GLM formalism. Although it breaks conservation of momentum and energy, it has proven to be more robust in treating low-beta plasma. </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a04198e1816b86c3752670bb99635033f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void GLM_ExtendedSource </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_state__1_d.html">State_1D</a> *&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>beg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_grid.html">Grid</a> *&#160;</td>
          <td class="paramname"><em>grid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Add source terms to the right hand side of the conservative equations, momentum and energy equations only. This yields the extended GLM equations given by Eq. (24a)&ndash;(24c) in</p>
<p>"Hyperbolic Divergence cleaning for the MHD Equations" Dedner et al. (2002), JcP, 175, 645 </p>

</div>
</div>
<a class="anchor" id="a50b706a077ad71dba043b93d789d4376"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void GLM_Init </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_data.html">Data</a> *&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_time___step.html">Time_Step</a> *&#160;</td>
          <td class="paramname"><em>Dts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_grid.html">Grid</a> *&#160;</td>
          <td class="paramname"><em>grid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Initialize the maximum propagation speed <a class="el" href="glm_8c.html#a7f176850b7d2e1bc4d2f50b3c52bff47">glm_ch</a>. </p>

</div>
</div>
<a class="anchor" id="a1e39b2e3fc2139dbef1fd1bc297e1d6b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void GLM_Solve </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_state__1_d.html">State_1D</a> *&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname"><em>VL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname"><em>VR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>beg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_grid.html">Grid</a> *&#160;</td>
          <td class="paramname"><em>grid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Solve the 2x2 linear hyperbolic GLM-MHD system given by the divergence cleaning approach. Build new states VL and VR for Riemann problem. We use Eq. (42) of Dedner et al (2002)</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">state</td><td>pointer to a <a class="el" href="struct_state__1_d.html">State_1D</a> structure </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">VL</td><td>left-interface state to be passed to the Riemann solver </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">VR</td><td>right-interface state to be passed to the Riemann solver </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">beg</td><td>starting index of computation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">end</td><td>final index of computation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">grid</td><td>pointer to array of <a class="el" href="struct_grid.html">Grid</a> structures</td></tr>
  </table>
  </dd>
</dl>
<p>The purpose of this function is two-fold:</p>
<ol type="1">
<li>assign a unique value to the normal component of magnetic field and to te scalar psi <em>before</em> the actual Riemann solver is called.</li>
<li>compute GLM fluxes in Bn and psi.</li>
</ol>
<p>The following MAPLE script has been used </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;restart;</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;with(linalg);</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;A := matrix(2,2,[ 0, 1, c^2, 0]);</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;R := matrix(2,2,[ 1, 1, c, -c]);</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;L := inverse(R);</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;E := matrix(2,2,[c,0,0,-c]);</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;multiply(R,multiply(E,L));</div>
</div><!-- fragment --> 
</div>
</div>
<a class="anchor" id="a793d2e1cde4e678c8fe569a03bda5484"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void GLM_Source </td>
          <td>(</td>
          <td class="paramtype">const Data_Arr&#160;</td>
          <td class="paramname"><em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_grid.html">Grid</a> *&#160;</td>
          <td class="paramname"><em>grid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Include the parabolic source term of the Lagrangian multiplier equation in a split fashion for the mixed GLM formulation. Ref. Mignone &amp; Tzeferacos, JCP (2010) 229, 2117, Equation (27). </p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="a7f176850b7d2e1bc4d2f50b3c52bff47"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double glm_ch</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The propagation speed of divergence error. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Aug 31 2015 12:33:06 for PLUTO by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.8
</small></address>
</body>
</html>
