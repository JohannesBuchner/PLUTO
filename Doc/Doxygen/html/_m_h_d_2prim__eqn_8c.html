<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PLUTO: /Users/mignone/PLUTO/Src/MHD/prim_eqn.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">PLUTO
   &#160;<span id="projectnumber">4.3</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_413f4e031a85da0d68269c6fd2f76e1c.html">Src</a></li><li class="navelem"><a class="el" href="dir_393faf7c97aebfe9abb0723b81bbf748.html">MHD</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">prim_eqn.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Compute the right hand side of the primitive MHD equations.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="pluto_8h_source.html">pluto.h</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aca4116e364d50622e96a380a2fdf7995"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_m_h_d_2prim__eqn_8c.html#aca4116e364d50622e96a380a2fdf7995">PrimRHS</a> (double *v, double *dv, double cs2, double h, double *Adv)</td></tr>
<tr class="separator:aca4116e364d50622e96a380a2fdf7995"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd847436af871261dab90f2f524d4adf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_m_h_d_2prim__eqn_8c.html#abd847436af871261dab90f2f524d4adf">PrimSource</a> (const <a class="el" href="struct_state.html">State</a> *gas, double **src, int beg, int end, <a class="el" href="struct_grid.html">Grid</a> *grid)</td></tr>
<tr class="separator:abd847436af871261dab90f2f524d4adf"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Implements the right hand side of the quasi-linear form of the MHD equations. In 1D this may be written as </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \partial_t{\mathbf{V}} = - A\cdot\partial_x\mathbf{V} + \mathbf{S} \]" src="form_112.png"/>
</p>
<p> where <img class="formulaInl" alt="$ A $" src="form_113.png"/> is the matrix of the primitive form of the equations, <img class="formulaInl" alt="$ S $" src="form_114.png"/> is the source term.</p>
<p><b>Reference</b> </p>
<ul>
<li>"A solution adaptive upwind scheme for ideal MHD", Powell et al., JCP (1999) 154, 284.</li>
</ul>
<p>The function <a class="el" href="_h_d_2prim__eqn_8c.html#aca4116e364d50622e96a380a2fdf7995">PrimRHS()</a> implements the first term while <a class="el" href="_h_d_2prim__eqn_8c.html#a9f2407ef2a07d31d8deb5ab21e3da1f8">PrimSource()</a> implements the source term part.</p>
<dl class="section author"><dt>Author</dt><dd>A. Mignone (<a href="#" onclick="location.href='mai'+'lto:'+'mig'+'no'+'ne@'+'ph'+'.un'+'it'+'o.i'+'t'; return false;">migno<span style="display: none;">.nosp@m.</span>ne@p<span style="display: none;">.nosp@m.</span>h.uni<span style="display: none;">.nosp@m.</span>to.i<span style="display: none;">.nosp@m.</span>t</a>) </dd></dl>
<dl class="section date"><dt>Date</dt><dd>March 1, 2017 </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="aca4116e364d50622e96a380a2fdf7995"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aca4116e364d50622e96a380a2fdf7995">&#9670;&nbsp;</a></span>PrimRHS()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PrimRHS </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>dv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>cs2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>Adv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute the matrix-vector multiplication <img class="formulaInl" alt="$ A(\mathbf{v})\cdot d\mathbf{v} $" src="form_175.png"/> where A is the matrix of the quasi-linear form of the MHD equations.</p>
<p><b>References</b> </p>
<ul>
<li>"A solution adaptive upwind scheme for ideal MHD", Powell et al., JCP (1999) 154, 284</li>
<li>"An unsplit Godunov method for ideal MHD via constrained transport" Gardiner &amp; Stone, JCP (2005) 205, 509</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">v</td><td>vector of primitive variables </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dv</td><td>limited (linear) slopes </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cs2</td><td>local sound speed </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">h</td><td>local enthalpy </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">AdV</td><td>matrix-vector product</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>This function has no return value. </dd></dl>
<dl class="section note"><dt>Note</dt><dd>In the 7-wave and 8-wave formulations we use the the same matrix being decomposed into right and left eigenvectors during the Characteristic Tracing step. Note, however, that it DOES NOT include two additional terms (-vy*dV[BX] for By, -vz*dv[BX] for Bz) that are needed in the <h2>7-wave form and are added using source terms. </h2>
</dd></dl>

</div>
</div>
<a id="abd847436af871261dab90f2f524d4adf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abd847436af871261dab90f2f524d4adf">&#9670;&nbsp;</a></span>PrimSource()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PrimSource </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_state.html">State</a> *&#160;</td>
          <td class="paramname"><em>gas</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>beg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_grid.html">Grid</a> *&#160;</td>
          <td class="paramname"><em>grid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute source terms of the MHD equations in primitive variables. These include:</p>
<ul>
<li>Geometrical sources;</li>
<li>Shearing-box terms</li>
<li>Gravity;</li>
<li>terms related to divergence of B control (Powell eight wave and GLM);</li>
<li>FARGO source terms.</li>
</ul>
<p>The rationale for choosing during which sweep a particular source term has to be incorporated should match the same criterion used during the conservative update. For instance, in polar or cylindrical coordinates, curvilinear source terms are included during the radial sweep only.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">gas</td><td>pointer to a <a class="el" href="struct_sweep.html">Sweep</a> structure </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">src</td><td>array of source terms </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">beg</td><td>initial index of computation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">end</td><td>final index of computation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">grid</td><td>pointer to a <a class="el" href="struct_grid.html">Grid</a> structure</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This function does not work in spherical coordinates yet. For future implementations we annotate hereafter the induction equation in spherical coordinates:</dd></dl>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \partial_tB_r + \frac{1}{r}\partial_\theta E_\phi - \frac{1}{r\sin\theta}\partial_\phi E_\theta = -E_\phi\cot\theta/r \]" src="form_176.png"/>
</p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \partial_t B_\theta + \frac{1}{r\sin\theta}\partial_\phi E_r - \partial_rE_\phi = E_\phi/r \]" src="form_177.png"/>
</p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \partial_t B_\phi + \partial_r E_\theta - \frac{1}{r}\partial_\theta E_r = - E_\theta/r\]" src="form_178.png"/>
</p>
<p>where </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ E_\phi = -(v \times B)_\phi = - (v_r B_\theta - v_\theta B_r) \,,\qquad E_\theta = -(v \times B)_\theta = - (v_\phi B_r - v_r B_\phi) \]" src="form_179.png"/>
</p>
 
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Jun 7 2018 18:33:50 for PLUTO by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
