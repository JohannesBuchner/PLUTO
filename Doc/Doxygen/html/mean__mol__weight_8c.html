<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>PLUTO: /Users/mignone/PLUTO/Src/mean_mol_weight.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">PLUTO
   &#160;<span id="projectnumber">4.2</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_413f4e031a85da0d68269c6fd2f76e1c.html">Src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">mean_mol_weight.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Compute the mean molecular weight.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="pluto_8h_source.html">pluto.h</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a29988943ac39ad7160dcd08944a6b83b"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mean__mol__weight_8c.html#a29988943ac39ad7160dcd08944a6b83b">MeanMolecularWeight</a> (double *v)</td></tr>
<tr class="separator:a29988943ac39ad7160dcd08944a6b83b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Compute and return the mean molecular weight as a function of the gas composition under non-equilibrium conditions. The mean molecular weight is usually needed to compute the temperature or mass density from the particle number density: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ T = \frac{p}{n_{\rm tot}k_B} = \frac{p}{\rho}\frac{m_u\mu}{k_B} \,,\qquad \rho = \mu m_u n_{\rm tot} \]" src="form_103.png"/>
</p>
<p> where <img class="formulaInl" alt="$ m_u $" src="form_104.png"/> is the atomic mass unit while <img class="formulaInl" alt="$ n_{\rm tot} $" src="form_105.png"/> is the number density of all particles. The Mean molecular weight is defined as the average mass of a particle of gas in terms of the atomic mass unit and it is expressed by the weighted sum of the mass of particles in atomic mass unit divided by total number of particles (see book by Ryan &amp; Norton [Eq. 1.7]) </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \mu = \frac{\DS\sum_k N_k \frac{m_k}{m_u}}{\DS\sum_k N_k} \]" src="form_106.png"/>
</p>
<p> where</p><ul>
<li><img class="formulaInl" alt="$ N_k $" src="form_107.png"/> is the number of particles in the gas of element k and it can be related to mass fraction <img class="formulaInl" alt="$X_k$" src="form_108.png"/> as <img class="formulaInl" alt="$\DS \frac{N_k}{V} = n_k = \frac{\rho}{m_u}\frac{X_k}{A_k}$" src="form_109.png"/>, where <img class="formulaInl" alt="$A_k$" src="form_110.png"/> is the atomic mass number.</li>
<li><img class="formulaInl" alt="$ m_k $" src="form_111.png"/> is the mass of each particle of element k.</li>
</ul>
<p><b>H2_COOL:</b> to compute <img class="formulaInl" alt="$\mu$" src="form_112.png"/> we proceed as follows:</p><ol type="1">
<li>using standard solar composition <img class="formulaInl" alt="$ X_{\odot},\, Y_{\odot},\, Z_{\odot}$" src="form_113.png"/> we derive <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \frac{N_{He}}{N_H} = \frac{Y_{\odot}}{A_{He}}\frac{A_H}{X_\odot} ,\,\qquad \frac{N_Z}{N_H} = \frac{Z_{\odot}}{A_{Z}}\frac{A_H}{X_\odot} \]" src="form_114.png"/>
</p>
</li>
<li>The weighted sum of the mass of particles in the numerator of <img class="formulaInl" alt="$\mu$" src="form_112.png"/> is given by <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \sum_k N_k \frac{m_k}{m_u} = N_H \frac{m_H}{m_u} + N_{He}\frac{m_{He}}{m_u} + N_Z \frac{m_Z}{m_u} \]" src="form_115.png"/>
</p>
 Note that since mass of electron is negligible, so is its contribution to the previous summation.</li>
<li>For the denominator we have <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \sum_k N_k = N_{HI} + N_{HII} + N_{H2} + N_e + N_{He} + N_Z + \frac{A_ZN_Z}{2} \]" src="form_116.png"/>
</p>
 where two sources of electrons considered here: <img class="formulaInl" alt="$ N_e $" src="form_117.png"/> electrons corresponding to <img class="formulaInl" alt="$ N_{HII} $" src="form_118.png"/> protons due to ionization of hydrogen and <img class="formulaInl" alt="$ A_ZN_Z/2 $" src="form_119.png"/> number of electrons due to metals. Note that now the electrons contribute to the total number of particles and cannot be neglected.</li>
<li>Next define the total number of hydrogen, <img class="formulaInl" alt="$ N_H = N_{HI} + N_{HII} + 2N_{H2} $" src="form_120.png"/> as the sum of number of atomic hydrogen (HI), ionized hydrogen (HII, or protons) and twice the number of molecular hydrogen (H2) and the corresponding number fractions: <p class="formulaDsp">
<img class="formulaDsp" alt="\[ f_{HI} = \frac{N_{HI}}{N_H},\quad f_{HII} = \frac{N_{HII}}{N_H},\quad f_{H2} = \frac{N_{H2}}{N_H},\quad \]" src="form_121.png"/>
</p>
 so that <img class="formulaInl" alt="$ f_{HI} + 2f_{H2} + f_{HII} = 1 $" src="form_122.png"/>.</li>
</ol>
<p>Putting it all together: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \mu = \frac{A_H + A_{He}f_{He} + A_Zf_Z} {f_{HI} + f_{H2} + 2f_{HII} + f_{He} + f_Z + A_Z f_Z/2} \]" src="form_123.png"/>
</p>
<p> where</p><ul>
<li><img class="formulaInl" alt="$A_{He}, A_Z $" src="form_124.png"/> are atomic mass numbers of helium and metals respectively.</li>
<li><img class="formulaInl" alt="$f_{He} = N_{He}/N_H$" src="form_125.png"/> is the fixed number fraction of helium with respect to hydrogen;</li>
<li><img class="formulaInl" alt="$f_Z = N_Z/N_H$" src="form_126.png"/> is the fixed number fraction of metals with respect to hydrogen.</li>
</ul>
<p><b>MINEq:</b> please see Eq. [12] of Tesileanu (2008)</p>
<p><b>SNEq:</b> the derivation is similar to H2_COOL with <img class="formulaInl" alt="$ f_{H2} = 0$" src="form_127.png"/> yielding </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \mu = \frac{A_H + A_{He}f_{He} + A_Zf_Z} {2 - f_{HI} + f_{He} + 2f_Z} \]" src="form_128.png"/>
</p>
<p> where one electron from metals is assumed.</p>
<p><b>No</b> <b>Chemistry:</b> in case where chemical reaction are not incuded, the mean molecular weight is computed from the mass fractions assuming a fully ionized gas: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \mu = \frac{A_H + A_{He}f_{He} + A_Zf_Z}{2 + f_{He} + f_Z(1 + A_Z/2)} \]" src="form_129.png"/>
</p>
<p><b>References</b> </p><ul>
<li>"Stellar Evolution and Nucleosynthesis" Sean G. Ryan and Andrew J. Norton. The University of Chicago Press</li>
<li>"Simulating radiative astrophysical flows with the PLUTO code:
      a non-equilibrium, multi-species cooling function", Tesileanu, Mignone &amp; Massaglia, A&amp;A (2008) 488, 429</li>
</ul>
<dl class="section author"><dt>Authors</dt><dd>A. Mignone (<a href="#" onclick="location.href='mai'+'lto:'+'mig'+'no'+'ne@'+'ph'+'.un'+'it'+'o.i'+'t'; return false;">migno<span style="display: none;">.nosp@m.</span>ne@p<span style="display: none;">.nosp@m.</span>h.uni<span style="display: none;">.nosp@m.</span>to.i<span style="display: none;">.nosp@m.</span>t</a>)<br />
 B. Vaidya</dd></dl>
<dl class="section date"><dt>Date</dt><dd>Aug 11, 2015 </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a29988943ac39ad7160dcd08944a6b83b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double MeanMolecularWeight </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>v</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return the mean molecular weight.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">v</td><td>array of primitive variables (including ions) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Aug 31 2015 12:33:06 for PLUTO by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.8
</small></address>
</body>
</html>
