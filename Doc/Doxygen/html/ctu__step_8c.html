<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>PLUTO: /Users/mignone/PLUTO/Src/Time_Stepping/ctu_step.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">PLUTO
   &#160;<span id="projectnumber">4.2</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_413f4e031a85da0d68269c6fd2f76e1c.html">Src</a></li><li class="navelem"><a class="el" href="dir_8239a6a3a28c8d42ffb2efb4ffd69d6c.html">Time_Stepping</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">ctu_step.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Advance equations using Corner Transport Upwind (CTU).  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="pluto_8h_source.html">pluto.h</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a5319fd6d5ab7127d54d323017e728a57"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ctu__step_8c.html#a5319fd6d5ab7127d54d323017e728a57">CTU_CT_Source</a> (double **, double **, double **, double *, int, int, <a class="el" href="struct_grid.html">Grid</a> *)</td></tr>
<tr class="separator:a5319fd6d5ab7127d54d323017e728a57"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ae2eb5c623934ef7af9541e241c550e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ctu__step_8c.html#a0ae2eb5c623934ef7af9541e241c550e">AdvanceStep</a> (const <a class="el" href="struct_data.html">Data</a> *d, Riemann_Solver *Riemann, <a class="el" href="struct_time___step.html">Time_Step</a> *Dts, <a class="el" href="struct_grid.html">Grid</a> *grid)</td></tr>
<tr class="separator:a0ae2eb5c623934ef7af9541e241c550e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Implement the dimensionally unsplit, Corner Transport Upwind method (CTU) of Colella. It consists of</p>
<p><b> A predictor step </b>:</p><ol type="1">
<li>start from cell center values of <code>V</code> and compute time-centered interface states using either HANCOCK or CHARACTERISTIC_TRACING: <p class="formulaDsp">
<img class="formulaDsp" alt="\[ V^{n+\HALF}_{i,\pm} = V^n_{i,\pm} + \pd{V}{t}\frac{\Delta t}{2} \]" src="form_238.png"/>
</p>
 Store the resulting states by converting <img class="formulaInl" alt="$ V_\pm $" src="form_239.png"/> in <img class="formulaInl" alt="$ U_\pm $" src="form_240.png"/> (= <code>UP</code>, <code>UM</code>). Normal (n) and trasnverse (t) indexes for this step should span <img class="formulaInl" alt="$ n \in [n_{\rm beg} - 1, n_{\rm end} + 1] $" src="form_241.png"/>, <img class="formulaInl" alt="$ t \in [t_{\rm beg} - 1, t_{\rm end} + 1] $" src="form_242.png"/> for cell-centered schemes and <img class="formulaInl" alt="$ n \in [n_{\rm beg} - 2, n_{\rm end} + 2] $" src="form_243.png"/>, <img class="formulaInl" alt="$ t \in [t_{\rm beg} - 2, t_{\rm end} + 2] $" src="form_244.png"/> for staggered MHD.</li>
<li>Solve Riemann problems between <img class="formulaInl" alt="$ V_{i,+}$" src="form_245.png"/> and <img class="formulaInl" alt="$ V_{i+1,-}$" src="form_246.png"/> and store the flux difference in RHS.</li>
<li>Compute cell and time-centered values UH = U + dt/2*RHS with index range <img class="formulaInl" alt="$ n \in [n_{\rm beg}, n_{\rm end}]$" src="form_247.png"/>, <img class="formulaInl" alt="$ t \in [t_{\rm beg}, t_{\rm end}]$" src="form_248.png"/> for cell-centered schemes and <img class="formulaInl" alt="$ n \in [n_{\rm beg}-1, n_{\rm end}+1]$" src="form_249.png"/>, <img class="formulaInl" alt="$ t \in [t_{\rm beg}-1, t_{\rm end}+1]$" src="form_250.png"/> for staggered MHD.</li>
</ol>
<p><b> A corrector step </b>:</p><ol type="1">
<li>correct left and right states <code>UP</code> and <code>UM</code> computed in the previous step by adding the transverse RHS contribution, e.g. <img class="formulaInl" alt="$ U^{n+\HALF}_{i\pm} += ({\cal RHS}^n_y + {\cal RHS}^n_z)\Delta t/2 $" src="form_251.png"/>. This step should cover <img class="formulaInl" alt="$ [n_{\rm beg}-1, n_{\rm end} + 1]$" src="form_252.png"/>, <img class="formulaInl" alt="$ [t_{\rm beg}, t_{\rm end}]$" src="form_253.png"/> for cell-centered MHD and <img class="formulaInl" alt="$ [n_{\rm beg}-2, n_{\rm end} + 2]$" src="form_254.png"/>, <img class="formulaInl" alt="$ [t_{\rm beg}-1, tend+1]$" src="form_255.png"/> for staggered MHD.</li>
<li>Solve a normal Riemann problem with left and right states <code>UP</code> and <code>UM</code>, get RHS and evolve to final stage, <img class="formulaInl" alt="$ U^{n+1} = U^n + \Delta t^n {\cal RHS}^{n+\HALF} $" src="form_256.png"/></li>
</ol>
<p>This integrator performs an integration in the ghost boundary zones, in order to recover appropriate information to build the transverse predictors.</p>
<dl class="section note"><dt>Note</dt><dd>If explicit parabolic flux have to be included, the predictor step is modified by computing the RHS from 1st order states at t^n. This allows to obtain space and time centered states in one row of boundary zones required during the following corrector step.</dd></dl>
<p><b>References</b> </p><ul>
<li>"The Piecewise Parabolic Method for Multidimensional 
      Relativistic Fluid Dynamics" <br />
 Mignone, A.; Plewa, T.; Bodo, G. ApJS (2005), 160..199M</li>
<li>"An unsplit Godunov method for ideal MHD via constrained transport" <br />
 Gardiner &amp; Stone, JCP (2005), 205, 509</li>
<li>"A second-order unsplit Godunov scheme for cell-centered MHD:
      the CTU-GLM scheme" <br />
 Mignone &amp; Tzeferacos JCP (2010), 229, 2117</li>
</ul>
<dl class="section author"><dt>Authors</dt><dd>A. Mignone (<a href="#" onclick="location.href='mai'+'lto:'+'mig'+'no'+'ne@'+'ph'+'.un'+'it'+'o.i'+'t'; return false;">migno<span style="display: none;">.nosp@m.</span>ne@p<span style="display: none;">.nosp@m.</span>h.uni<span style="display: none;">.nosp@m.</span>to.i<span style="display: none;">.nosp@m.</span>t</a>)<br />
 P. Tzeferacos (<a href="#" onclick="location.href='mai'+'lto:'+'pet'+'ro'+'s.t'+'ze'+'fer'+'ac'+'os@'+'ph'+'.un'+'it'+'o.i'+'t'; return false;">petro<span style="display: none;">.nosp@m.</span>s.tz<span style="display: none;">.nosp@m.</span>efera<span style="display: none;">.nosp@m.</span>cos@<span style="display: none;">.nosp@m.</span>ph.un<span style="display: none;">.nosp@m.</span>ito.<span style="display: none;">.nosp@m.</span>it</a>) </dd></dl>
<dl class="section date"><dt>Date</dt><dd>June 24, 2015 </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a0ae2eb5c623934ef7af9541e241c550e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int AdvanceStep </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_data.html">Data</a> *&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Riemann_Solver *&#160;</td>
          <td class="paramname"><em>Riemann</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_time___step.html">Time_Step</a> *&#160;</td>
          <td class="paramname"><em>Dts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_grid.html">Grid</a> *&#160;</td>
          <td class="paramname"><em>grid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Advance equations using the corner transport upwind method (CTU)</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">d</td><td>pointer to <a class="el" href="struct_data.html">Data</a> structure </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Riemann</td><td>pointer to a Riemann solver function </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">Dts</td><td>pointer to time step structure </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">grid</td><td>pointer to array of <a class="el" href="struct_grid.html">Grid</a> structures </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a5319fd6d5ab7127d54d323017e728a57"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void CTU_CT_Source </td>
          <td>(</td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname"><em>up</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname"><em>um</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>dtdV</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>beg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_grid.html">Grid</a> *&#160;</td>
          <td class="paramname"><em>grid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Add source terms to conservative left and right states obtained from the primitive form of the equations. The source terms are:</p>
<ul>
<li>m += dt/2 * B * dbx/dx</li>
<li>Bt += dt/2 * vt * dbx/dx (t = transverse component)</li>
<li>E += dt/2 * v*B * dbx/dx</li>
</ul>
<p>These terms are NOT accounted for when the primitive form of the equations is used (see Gardiner &amp; Stone JCP (2005), Crockett et al. JCP(2005)). This is true for both the Charactheristic Tracing AND the primitive Hancock scheme when the constrained transport is used, since the resulting system is 7x7. To better understand this, you can consider the stationary solution rho = p = 1, v = 0 and Bx = x, By = -y. If these terms were not included the code would generate spurious velocities. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Aug 31 2015 12:33:06 for PLUTO by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.8
</small></address>
</body>
</html>
