<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PLUTO Test Problems: /Users/mignone/PLUTO/Test_Problems/MHD/Resistive_MHD/Linear_Force_Free/init.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">PLUTO Test Problems
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_a9bf029e8facab698e5e604ecb0bd3eb.html">MHD</a></li><li class="navelem"><a class="el" href="dir_a3eeefc454d9ced562a5332f77ee0e69.html">Resistive_MHD</a></li><li class="navelem"><a class="el" href="dir_fe4e321a2bda7626821ce921fd71411a.html">Linear_Force_Free</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">init.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Diffusion of a linear force-free magnetic field in cylindrical coordinates.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aec5cba6ad33e98822880b5199543c6e7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_m_h_d_2_resistive___m_h_d_2_linear___force___free_2init_8c.html#aec5cba6ad33e98822880b5199543c6e7">InitDomain</a> (Data *d, Grid *grid)</td></tr>
<tr class="separator:aec5cba6ad33e98822880b5199543c6e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Solve the diffusion equation for a linear force-free magnetic field in cylindrical coordinates. A force-free field satisfies </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \vec{J} \times \vec{B} = 0 \qquad\Longrightarrow\qquad \vec{J} = \nabla\times\vec{B} = \mu \vec{B} \]" src="form_187.png"/>
</p>
<p> which means that <img class="formulaInl" alt="$\vec{J}$" src="form_188.png"/> and <img class="formulaInl" alt="$\vec{B}$" src="form_189.png"/> must be parallel. If <img class="formulaInl" alt="$ \mu $" src="form_190.png"/> is constant then the solution is given by the Bessel functions: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ B_z(r) = B_0 J_1(\mu r) \,,\qquad B_\phi(r) = B_0 J_0(\mu r) \]" src="form_191.png"/>
</p>
<p> with vector potential given by </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ A_z(r) = - \int J_1(\mu r)\,dr = \frac{1}{\mu}J_0(\mu r) \,,\qquad A_\phi(r) = - \frac{1}{r}\int rJ_0(\mu r)\,dr = \frac{1}{\mu}J_0(\mu r) \]" src="form_192.png"/>
</p>
<p> For constant resistivity and zero velocity the induction equation simplifies as follows: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \frac{d\vec{B}}{dt} = - \nabla\times (\eta \vec{J}) = - \nabla\times (\eta \mu \vec{B}) = -\eta \mu^2 \vec{B} \]" src="form_193.png"/>
</p>
<p> which admits the exact analytical solution <img class="formulaInl" alt="$\vec{B}(r,t) = \vec{B}(r,0) \exp(-\eta\mu^2 t)$" src="form_194.png"/> meaning that the field remains force free also at subsequent times.</p>
<p>In the test we set <img class="formulaInl" alt="$\mu = \eta = 1$" src="form_195.png"/>.</p>
<p>Note that if pressure and density are initially constant and the velocity is also initially zero everywhere, the previous solution is also an exact solution of the isothermal MHD equations but not of the adiabatic MHD equations because of the Ohmic dissipation term (magnetic energy transforms into heat). However, using a large density makes pressure effects negligible.</p>
<ul>
<li>Configurations #01-03 solve the problem on a cylindrical domain away from the origin.</li>
<li>Configurations #04-06 extends the integration up to the origin and tests the quality of the discretization at r = 0</li>
<li>Configurations #08-09 are done in spherical coordinates.</li>
</ul>
<dl class="section author"><dt>Author</dt><dd>A. Mignone (<a href="#" onclick="location.href='mai'+'lto:'+'mig'+'no'+'ne@'+'ph'+'.un'+'it'+'o.i'+'t'; return false;">migno<span style="display: none;">.nosp@m.</span>ne@p<span style="display: none;">.nosp@m.</span>h.uni<span style="display: none;">.nosp@m.</span>to.i<span style="display: none;">.nosp@m.</span>t</a>) </dd></dl>
<dl class="section date"><dt>Date</dt><dd>March 20, 2017 </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="aec5cba6ad33e98822880b5199543c6e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aec5cba6ad33e98822880b5199543c6e7">&#9670;&nbsp;</a></span>InitDomain()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void InitDomain </td>
          <td>(</td>
          <td class="paramtype">Data *&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Grid *&#160;</td>
          <td class="paramname"><em>grid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Assign initial condition by looping over the computational domain. Called after the usual <a class="el" href="_particles_2_c_r_2_gyration_2init_8c.html#a8488b38b779097d732c203983f9bb9bf">Init()</a> function to assign initial conditions on primitive variables. Value assigned here will overwrite those prescribed during <a class="el" href="_particles_2_c_r_2_gyration_2init_8c.html#a8488b38b779097d732c203983f9bb9bf">Init()</a>. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Jun 15 2018 22:46:22 for PLUTO Test Problems by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
