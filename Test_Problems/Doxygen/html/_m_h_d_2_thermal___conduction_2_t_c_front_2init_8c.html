<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PLUTO Test Problems: /Users/mignone/PLUTO/Test_Problems/MHD/Thermal_Conduction/TCFront/init.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">PLUTO Test Problems
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_a9bf029e8facab698e5e604ecb0bd3eb.html">MHD</a></li><li class="navelem"><a class="el" href="dir_0c45943f5acca8016050e3c89fc61dea.html">Thermal_Conduction</a></li><li class="navelem"><a class="el" href="dir_37de83ee29dd4642dc9235c5ff406f5d.html">TCFront</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">init.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Propagation of a conduction front.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a840827a6d99dee4807a5efbf3c4542e3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_m_h_d_2_thermal___conduction_2_t_c_front_2init_8c.html#a840827a6d99dee4807a5efbf3c4542e3">Analysis</a> (const Data *d, Grid *grid)</td></tr>
<tr class="separator:a840827a6d99dee4807a5efbf3c4542e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec5cba6ad33e98822880b5199543c6e7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_m_h_d_2_thermal___conduction_2_t_c_front_2init_8c.html#aec5cba6ad33e98822880b5199543c6e7">InitDomain</a> (Data *d, Grid *grid)</td></tr>
<tr class="separator:aec5cba6ad33e98822880b5199543c6e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>The problem sets the initial condition for a propagating conduction front for which an analytical solution exists (Reale 1995).</p>
<p>The equation </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \frac{\partial T}{\partial t} = a\frac{\partial}{\partial s} \left(T^n\frac{\partial T}{\partial s}\right) \]" src="form_227.png"/>
</p>
<p> has the solution </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ T = T_c\left(1 - \frac{s^2}{s_f^2}\right)^{1/n} \]" src="form_228.png"/>
</p>
<p> where </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ T_c = \left(\frac{Q^2}{at}\right)^{1/(n+2)} \left(\frac{n}{2(n+2)}\zeta_0^2\right)^{1/n}\,, \quad\quad\quad s_f = (aQ^nt)^{1/(n+2)}\zeta_0\,, \quad\quad\quad \zeta_0 = \left[\frac{(n+2)^{1+n}2^{1-n}}{n\pi^{n/2}}\right]^{1/(n+2)} \left[\frac{\Gamma(1/2 + 1/n)}{\Gamma(1/n)}\right]^{n/(n+2)}\,, \]" src="form_229.png"/>
</p>
<p> <img class="formulaInl" alt="$Q$" src="form_230.png"/> is the integral over the whole space, and <img class="formulaInl" alt="$\Gamma$" src="form_231.png"/> is the gamma function.</p>
<p>The setup is built to compare the numerical solution with the analytical one.</p>
<p>In order to solve just the internal energy equation, we force the velocity to be zero using the internal boundary. We then deal with the internal energy equation (in cgs units) in presence of conduction, </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \label{eq:internal_energy} \pd{(\rho\epsilon)}{t} = \pd{}{x}\left[\kappa T^{5/2}\pd{T}{x}\right] \]" src="form_232.png"/>
</p>
<p> where <img class="formulaInl" alt="$\rho\epsilon$" src="form_233.png"/> is the gas internal energy (in cgs units), <img class="formulaInl" alt="$T$" src="form_234.png"/> is the temperature (in K), <img class="formulaInl" alt="$\kappa = 9.22\cdot 10^{-7}$" src="form_235.png"/> is the plasma thermal conductivity (in cgs units): The previous equation can be written in terms of the temperature variable only using </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \rho\epsilon = \frac{p}{\gamma-1} = \frac{2nk_BT}{\gamma-1} \qquad\qquad\Longrightarrow\qquad\qquad \pd{T}{x} = a \pd{}{x}\left(T^{5/2}\pd{T}{x}\right) \]" src="form_236.png"/>
</p>
<p> where <img class="formulaInl" alt="$n=10^{10} \,{\rm cm}^{-3}$" src="form_237.png"/> ( <img class="formulaInl" alt="$10^{9}$" src="form_238.png"/> is employed in 1D) is the plasma number density, <img class="formulaInl" alt="$\gamma=5/3$" src="form_239.png"/> while </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ a = \frac{(\gamma-1)\kappa}{2nk_B} \approx 0.226 \qquad (Titos\quad uses\quad 4.212 \quad ) \]" src="form_240.png"/>
</p>
<p>In code (non-dimensional) units, we adopt <img class="formulaInl" alt="$t = t_0 \tilde{t}$" src="form_241.png"/>, <img class="formulaInl" alt="$x = L_0\tilde{x}$" src="form_242.png"/> and therefore Eq. (eq:internal_energy}) is solved as</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[\label{eq:internal_energy_code} \pd{(\widetilde{\rho\epsilon})}{\tilde{t}} = \left(\kappa \frac{t_0}{L_0^2}\frac{T_0^{5/2}}{2nk_B} \right) \pd{}{\tilde{x}}\left[\tilde{T}^{5/2} \pd{\tilde{T}}{\tilde{x}}\right] \]" src="form_243.png"/>
</p>
<p>Values with a tilde are dimensionless. Note that the reference velocity and temperature are computed directly from <img class="formulaInl" alt="$ t_0 = 1\,{\rm s}$ and $L_0 = 10^8\,{\rm cm} $" src="form_244.png"/>: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ v_0 = \frac{L_0}{t_0}\,,\qquad T_0 = \frac{m}{2k_B}v_0^2 \]" src="form_245.png"/>
</p>
<div class="image">
<img src="1D-hd-exp.jpg" alt="1D-hd-exp.jpg"/>
<div class="caption">
Evolution of the TC front in the 1D case; numerical solution (points) and analytical (lines)</div></div>
<p>.</p>
<p>Configurations (<code>EXPLICIT</code>, <code>STS</code>, <code>RKL</code>):</p><ul>
<li>#01-#03: 1D Cartesian</li>
<li>#04-#06: 2D Cylindrical</li>
<li>#07-#09: 3D Cartesian</li>
<li>#10-#12: 3D Polar</li>
<li>#13-#15: 2D Spherical</li>
<li>#16 2D cylindrical + chombo</li>
</ul>
<dl class="section author"><dt>Author</dt><dd>A. Mignone (<a href="#" onclick="location.href='mai'+'lto:'+'mig'+'no'+'ne@'+'ph'+'.un'+'it'+'o.i'+'t'; return false;">migno<span style="display: none;">.nosp@m.</span>ne@p<span style="display: none;">.nosp@m.</span>h.uni<span style="display: none;">.nosp@m.</span>to.i<span style="display: none;">.nosp@m.</span>t</a>) </dd></dl>
<dl class="section date"><dt>Date</dt><dd>March 11, 2018</dd></dl>
<p><b>References:</b> </p><ul>
<li>Section 4 of Reale, F. Computer Physics Communications (1995), 86, 13 </li>
</ul>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a840827a6d99dee4807a5efbf3c4542e3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a840827a6d99dee4807a5efbf3c4542e3">&#9670;&nbsp;</a></span>Analysis()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Analysis </td>
          <td>(</td>
          <td class="paramtype">const Data *&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Grid *&#160;</td>
          <td class="paramname"><em>grid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Generate Analytical solution </p>

</div>
</div>
<a id="aec5cba6ad33e98822880b5199543c6e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aec5cba6ad33e98822880b5199543c6e7">&#9670;&nbsp;</a></span>InitDomain()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void InitDomain </td>
          <td>(</td>
          <td class="paramtype">Data *&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Grid *&#160;</td>
          <td class="paramname"><em>grid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Assign initial condition by looping over the computational domain. Called after the usual <a class="el" href="_particles_2_c_r_2_gyration_2init_8c.html#a8488b38b779097d732c203983f9bb9bf">Init()</a> function to assign initial conditions on primitive variables. Value assigned here will overwrite those prescribed during <a class="el" href="_particles_2_c_r_2_gyration_2init_8c.html#a8488b38b779097d732c203983f9bb9bf">Init()</a>. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Jun 15 2018 22:46:22 for PLUTO Test Problems by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
