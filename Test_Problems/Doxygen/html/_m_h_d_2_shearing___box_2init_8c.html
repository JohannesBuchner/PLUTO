<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PLUTO Test Problems: /Users/mignone/PLUTO/Test_Problems/MHD/Shearing_Box/init.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">PLUTO Test Problems
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_a9bf029e8facab698e5e604ecb0bd3eb.html">MHD</a></li><li class="navelem"><a class="el" href="dir_aec06e308d9caee868e7d65e00e03139.html">Shearing_Box</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">init.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Shearing Box setup.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aec5cba6ad33e98822880b5199543c6e7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_m_h_d_2_shearing___box_2init_8c.html#aec5cba6ad33e98822880b5199543c6e7">InitDomain</a> (Data *d, Grid *grid)</td></tr>
<tr class="separator:aec5cba6ad33e98822880b5199543c6e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a840827a6d99dee4807a5efbf3c4542e3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_m_h_d_2_shearing___box_2init_8c.html#a840827a6d99dee4807a5efbf3c4542e3">Analysis</a> (const Data *d, Grid *grid)</td></tr>
<tr class="separator:a840827a6d99dee4807a5efbf3c4542e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a871556305428fad692c67884bcb270bd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_m_h_d_2_shearing___box_2init_8c.html#a871556305428fad692c67884bcb270bd">UserDefBoundary</a> (const Data *d, RBox *box, int side, Grid *grid)</td></tr>
<tr class="separator:a871556305428fad692c67884bcb270bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa16bb96fc83453c18831f9c50aaacd1b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_m_h_d_2_shearing___box_2init_8c.html#aa16bb96fc83453c18831f9c50aaacd1b">BodyForceVector</a> (double *v, double *g, double x, double y, double z)</td></tr>
<tr class="separator:aa16bb96fc83453c18831f9c50aaacd1b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1aaf201729d90f00407ee43fc7930002"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_m_h_d_2_shearing___box_2init_8c.html#a1aaf201729d90f00407ee43fc7930002">FARGO_SetVelocity</a> (double x1, double x2)</td></tr>
<tr class="separator:a1aaf201729d90f00407ee43fc7930002"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Set initial conditions for a shearing box model in two or three dimensions: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \rho = \left\{\begin{array}{ll} 1 &amp; \quad{\rm(unstratified)} \\ \noalign{\medskip} \exp(-z^2/H^2) &amp; \quad{\rm(stratified)} \end{array}\right. ;\quad v_y = -q\Omega x\,; \quad p = \rho c_s^2\,; \quad \vec{B} = \left\{\begin{array}{ll} (0,0,B_z) &amp; \quad{\rm(net\,flux)} \\ \noalign{\medskip} (0,0,B_z\sin 2\pi x/L_x) &amp; \quad{\rm(no\,net\,flux)} \end{array}\right. \]" src="form_204.png"/>
</p>
<p> where, by default, the angular rotation frequency is <img class="formulaInl" alt="$\Omega = 1$" src="form_205.png"/> while the shear parameter is <img class="formulaInl" alt="$ q = 3/2 $" src="form_206.png"/> (Keplerian rotation). In the stratified case the scale height is given by <img class="formulaInl" alt="$ H = \sqrt{2}c_s/\Omega $" src="form_207.png"/>. The parameters controlling the model are the elements of the array <code>g_inputParam:</code> </p>
<ul>
<li><code>g_inputParam[BETA]</code>: sets the plasma beta (midplane), <img class="formulaInl" alt="$ B_z = \sqrt{2c_s^2/\beta} $" src="form_208.png"/>;</li>
<li><code>g_inputParam[CSOUND]</code>: sets the speed of sound <img class="formulaInl" alt="$ c_s $" src="form_209.png"/>.</li>
</ul>
<p>The additional constants <code>NET_FLUX</code> and <code>STRATIFICATION</code> are defined inside <code>definitions.h</code> and are used to:</p>
<ul>
<li><code>NET_FLUX</code> (<code>YES/<code>NO</code>)</code>: set the magnetic field configuration corresponding to a net magnetic flux (<code>YES</code>) or zero-net flux (<code>NO</code>);</li>
<li><code>STRATIFICATION</code> (<code>YES/<code>NO</code>)</code>: enable or disable stratified shearing box models. With stratification, density and vertical gravity are changed.</li>
</ul>
<p>The <code>Shearing_Box/</code> directory contains several configurations for different purposes:</p>
<center> <table class="doxtable">
<tr>
<th>Conf.</th><th>DIM</th><th>NET_FLUX</th><th>STRAT.</th><th>T. STEPPING</th><th>RECONSTR. </th><th>EOS </th><th>Ref  </th></tr>
<tr>
<td>#01 </td><td>2 </td><td>YES </td><td>NO </td><td>HANCOCK </td><td>LINEAR </td><td>ISOTHERMAL</td><td>- </td></tr>
<tr>
<td>#02 </td><td>2 </td><td>YES </td><td>NO </td><td>ChTr </td><td>PARABOLIC </td><td>ISOTHERMAL</td><td>- </td></tr>
<tr>
<td>#03 </td><td>3 </td><td>YES </td><td>NO </td><td>RK2 </td><td>LINEAR </td><td>ISOTHERMAL</td><td>[Bod08] </td></tr>
<tr>
<td>#04 </td><td>3 </td><td>YES </td><td>NO </td><td>RK2 </td><td>LINEAR </td><td>ISOTHERMAL</td><td>[Bod08] </td></tr>
<tr>
<td>#05 </td><td>3 </td><td>YES </td><td>NO </td><td>ChTr </td><td>PARABOLIC </td><td>ISOTHERMAL</td><td>[Bod08] </td></tr>
<tr>
<td>#06 </td><td>3 </td><td>YES </td><td>NO </td><td>ChTr </td><td>PARABOLIC </td><td>ISOTHERMAL</td><td>[Bod08] </td></tr>
<tr>
<td>#07 </td><td>3 </td><td>NO </td><td>NO </td><td>RK2 </td><td>LINEAR </td><td>ISOTHERMAL</td><td>[Mig12] </td></tr>
<tr>
<td>#08 </td><td>3 </td><td>NO </td><td>NO </td><td>RK2 </td><td>LINEAR </td><td>ISOTHERMAL</td><td>[Mig12] (*) </td></tr>
<tr>
<td>#09 </td><td>3 </td><td>NO </td><td>NO </td><td>ChTr </td><td>PARABOLIC </td><td>ISOTHERMAL</td><td>[Mig12] </td></tr>
<tr>
<td>#10 </td><td>3 </td><td>NO </td><td>NO </td><td>ChTr </td><td>PARABOLIC </td><td>ISOTHERMAL</td><td>[Mig12] (*) </td></tr>
<tr>
<td>#11 </td><td>3 </td><td>NO </td><td>YES </td><td>HANCOCK </td><td>LINEAR </td><td>ISOTHERMAL</td><td>[Bod14] </td></tr>
<tr>
<td>#12 </td><td>3 </td><td>NO </td><td>YES </td><td>HANCOCK </td><td>LINEAR </td><td>IDEAL </td><td>[Bod12] (^) </td></tr>
<tr>
<td>#13 </td><td>3 </td><td>NO </td><td>NO </td><td>HANCOCK </td><td>LINEAR </td><td>IDEAL </td><td>(**) </td></tr>
<tr>
<td>#14 </td><td>3 </td><td>YES </td><td>NO </td><td>RK3 </td><td>WENO3 </td><td>IDEAL </td><td>(**) </td></tr>
</table>
</center><p>(*) used with FARGO to be compared to the previous configurations.</p>
<p>(**) as conf. #9 but with IDEAL eos and FARGO.</p>
<p>(^) This a simplified version of the [Bod12] setup. The actual configuration was also modifying the Riemann solver flux to guarantee zero mass flux across top and bottom boundary.</p>
<div class="image">
<img src="sb.06.png" alt="sb.06.png"/>
<div class="caption">
Density and magnetic field lines for configuration #06 at t = 50 using a grid resolution of 64 x 256 x 64.</div></div>
 <dl class="section author"><dt>Author</dt><dd>A. Mignone (<a href="#" onclick="location.href='mai'+'lto:'+'mig'+'no'+'ne@'+'ph'+'.un'+'it'+'o.i'+'t'; return false;">migno<span style="display: none;">.nosp@m.</span>ne@p<span style="display: none;">.nosp@m.</span>h.uni<span style="display: none;">.nosp@m.</span>to.i<span style="display: none;">.nosp@m.</span>t</a>) </dd></dl>
<dl class="section date"><dt>Date</dt><dd>March 2, 2017</dd></dl>
<p><b>References:</b> </p><ul>
<li>[Bod08]: "Aspect ratio dependence in magnetorotational instability 
               shearing box simulations" Bodo et al. A&amp;A (2008) 487, 1</li>
<li>[Mig12]: "A conservative orbital advection scheme for simulations of
               magnetized shear flows with the PLUTO code", Mignone et al., A&amp;A (2012) 545, Sec. 3.3.2</li>
<li>[Bod12]: "Magnetorotational turbulence in stratified shearing boxes
               with perfect gas equation of state and finite thermal diffusivity", Bodo et al., ApJ (2012) 761, 116</li>
<li>[Bod14]: "On the Convergence of Magnetorotational Turbulence in 
               Stratified Isothermal Shearing Boxes" Bodo et al. (2014) 787 L13 </li>
</ul>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a840827a6d99dee4807a5efbf3c4542e3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a840827a6d99dee4807a5efbf3c4542e3">&#9670;&nbsp;</a></span>Analysis()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Analysis </td>
          <td>(</td>
          <td class="paramtype">const Data *&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Grid *&#160;</td>
          <td class="paramname"><em>grid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute volume-integrated magnetic pressure, Maxwell and Reynolds stresses. Save them to "averages.dat" </p>

</div>
</div>
<a id="aa16bb96fc83453c18831f9c50aaacd1b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa16bb96fc83453c18831f9c50aaacd1b">&#9670;&nbsp;</a></span>BodyForceVector()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BodyForceVector </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>z</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Include gravitational force in the shearing box module. Coriolis terms are included elsewhere.</p>
<p>Note: with FARGO, gravity in the x-direction must not be included. </p>

</div>
</div>
<a id="a1aaf201729d90f00407ee43fc7930002"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1aaf201729d90f00407ee43fc7930002">&#9670;&nbsp;</a></span>FARGO_SetVelocity()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double FARGO_SetVelocity </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute the shear angular velocity to be subtracted from the HD or MHD equations. </p>

</div>
</div>
<a id="aec5cba6ad33e98822880b5199543c6e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aec5cba6ad33e98822880b5199543c6e7">&#9670;&nbsp;</a></span>InitDomain()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void InitDomain </td>
          <td>(</td>
          <td class="paramtype">Data *&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Grid *&#160;</td>
          <td class="paramname"><em>grid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Assign initial condition by looping over the computational domain. Called after the usual <a class="el" href="_particles_2_c_r_2_gyration_2init_8c.html#a8488b38b779097d732c203983f9bb9bf">Init()</a> function to assign initial conditions on primitive variables. Value assigned here will overwrite those prescribed during <a class="el" href="_particles_2_c_r_2_gyration_2init_8c.html#a8488b38b779097d732c203983f9bb9bf">Init()</a>. </p>

</div>
</div>
<a id="a871556305428fad692c67884bcb270bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a871556305428fad692c67884bcb270bd">&#9670;&nbsp;</a></span>UserDefBoundary()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void UserDefBoundary </td>
          <td>(</td>
          <td class="paramtype">const Data *&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">RBox *&#160;</td>
          <td class="paramname"><em>box</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>side</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Grid *&#160;</td>
          <td class="paramname"><em>grid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The user-defined boundary is used to impose stress-free boundary and purely vertical magnetic field at the top and bottom boundaries, as done in Bodo et al. (2012). In addition, constant temperature and hydrostatic balance are imposed. For instance, at the bottom boundary, one has: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \left\{\begin{array}{lcl} \DS \frac{dp}{dz} &amp;=&amp; \rho g_z \\ \noalign{\medskip} p &amp;=&amp; \rho c_s^2 \end{array}\right. \qquad\Longrightarrow\qquad \frac{p_{k+1}-p_k}{\Delta z} = \frac{p_{k} + p_{k+1}}{2c_s^2}g_z \]" src="form_210.png"/>
</p>
<p> where <img class="formulaInl" alt="$g_z$" src="form_211.png"/> is the value of gravity at the lower boundary. Solving for <img class="formulaInl" alt="$p_k$" src="form_212.png"/> at the bottom boundary where <img class="formulaInl" alt="$k=k_b-1$" src="form_213.png"/> gives: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \left\{\begin{array}{lcl} p_k &amp;=&amp; \DS p_{k+1} \frac{1-a}{1+a} \\ \noalign{\medskip} \rho_k &amp;=&amp; \DS \frac{p_k}{c_s^2} \end{array}\right. \qquad\mathrm{where}\qquad a = \frac{\Delta z g_z}{2c_s^2} &gt; 0 \]" src="form_214.png"/>
</p>
<p> where, for simplicity, we keep constant temperature in the ghost zones rather than at the boundary interface (this seems to give a more stable behavior and avoids negative densities). A similar treatment holds at the top boundary. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Jun 15 2018 22:46:22 for PLUTO Test Problems by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
