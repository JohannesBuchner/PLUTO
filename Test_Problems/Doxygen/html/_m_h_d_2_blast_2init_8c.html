<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>PLUTO Test Problems: /Users/mignone/PLUTO/Test_Problems/MHD/Blast/init.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">PLUTO Test Problems
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_a9bf029e8facab698e5e604ecb0bd3eb.html">MHD</a></li><li class="navelem"><a class="el" href="dir_444e7e6fa1b854b3357bc2e5634de267.html">Blast</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">init.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>MHD blast wave.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aadd0bb6736fd57811642342df2a86492"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_m_h_d_2_blast_2init_8c.html#aadd0bb6736fd57811642342df2a86492">BackgroundField</a> (double x1, double x2, double x3, double *B0)</td></tr>
<tr class="separator:aadd0bb6736fd57811642342df2a86492"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>The MHD blast wave problem has been specifically designed to show the scheme ability to handle strong shock waves propagating in highly magnetized environments. Depending on the strength of the magnetic field, it can become a rather arduous test leading to unphysical densities or pressures if the divergence-free condition is not adequately controlled and the numerical scheme does not introduce proper dissipation across curved shock fronts.</p>
<p>In this example the initial conditions consists of a static medium with uniform density <img class="formulaInl" alt="$ \rho = 1 $" src="form_47.png"/> while pressure and magnetic field are given by </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ p = \left\{\begin{array}{ll} p_{\rm in} &amp; \qquad\mathrm{for}\quad r < r_0 \\ \noalign{\medskip} p_{\rm out} &amp; \qquad\mathrm{otherwise} \\ \end{array}\right.\,;\qquad \vec{B} = B_0\left( \sin\theta\cos\phi\hvec{x} + \sin\theta\sin\phi\hvec{y} + \cos\theta\hvec{z}\right) \]" src="form_48.png"/>
</p>
<p> The values <img class="formulaInl" alt="$p_{\rm in},\, p_{\rm out},\, B_0,\, \theta,\, \phi,\, r_0$" src="form_49.png"/> are control parameters that can be changed from <code>pluto.ini</code> using, respectively,</p>
<ol type="1">
<li><code>g_inputParam[P_IN]</code></li>
<li><code>g_inputParam[P_OUT]</code></li>
<li><code>g_inputParam[BMAG]</code></li>
<li><code>g_inputParam[THETA]</code></li>
<li><code>g_inputParam[PHI]</code></li>
<li><code>g_inputParam[RADIUS]</code></li>
</ol>
<p>The over-pressurized region drives a blast wave delimited by an outer fast forward shock propagating (nearly) radially while magnetic field lines pile up behind the shock thus building a region of higher magnetic pressure. In these regions the shock becomes magnetically dominated and only weakly compressive ( <img class="formulaInl" alt="$\delta\rho/\rho\sim 1.2$" src="form_50.png"/> in both cases). The inner structure is delimited by an oval-shaped slow shock adjacent to a contact discontinuity and the two fronts tend to blend together as the propagation becomes perpendicular to the field lines. The magnetic energy increases behind the fast shock and decreases downstream of the slow shock. The resulting explosion becomes highly anisotropic and magnetically confined.</p>
<p>The available configurations are taken by collecting different setups available in literature:</p>
<center> <table class="doxtable">
<tr>
<th>Conf.</th><th>GEOMETRY </th><th>DIM</th><th>T. STEP.</th><th>INTERP. </th><th>divB</th><th>BCK_FIELD </th><th>Ref  </th></tr>
<tr>
<td>#01 </td><td>CARTESIAN </td><td>2 </td><td>RK2 </td><td>LINEAR </td><td>CT </td><td>NO </td><td>[BS99] </td></tr>
<tr>
<td>#02 </td><td>CARTESIAN </td><td>3 </td><td>RK2 </td><td>LINEAR </td><td>CT </td><td>NO </td><td>[Z04] </td></tr>
<tr>
<td>#03 </td><td>CYLINDRICAL</td><td>2 </td><td>RK2 </td><td>LINEAR </td><td>CT </td><td>NO </td><td>[Z04] (*) </td></tr>
<tr>
<td>#04 </td><td>CYLINDRICAL</td><td>2 </td><td>RK2 </td><td>LINEAR </td><td>CT </td><td>YES </td><td>[Z04] (*) </td></tr>
<tr>
<td>#05 </td><td>CARTESIAN </td><td>3 </td><td>RK2 </td><td>LINEAR </td><td>CT </td><td>YES </td><td>[Z04] </td></tr>
<tr>
<td>#06 </td><td>CARTESIAN </td><td>3 </td><td>ChTr </td><td>PARABOLIC</td><td>CT </td><td>NO </td><td>[GS08],[MT10] </td></tr>
<tr>
<td>#07 </td><td>CARTESIAN </td><td>3 </td><td>ChTr </td><td>LINEAR </td><td>CT </td><td>NO </td><td>[GS08],[MT10] </td></tr>
<tr>
<td>#08 </td><td>CARTESIAN </td><td>2 </td><td>ChTr </td><td>LINEAR </td><td>GLM</td><td>NO </td><td>[MT10] (2D version) </td></tr>
<tr>
<td>#09 </td><td>CARTESIAN </td><td>3 </td><td>ChTr </td><td>LINEAR </td><td>GLM</td><td>NO </td><td>[GS08],[MT10] </td></tr>
<tr>
<td>#10 </td><td>CARTESIAN </td><td>3 </td><td>RK2 </td><td>LINEAR </td><td>CT </td><td>YES </td><td>[Z04] </td></tr>
<tr>
<td>#11 </td><td>CARTESIAN </td><td>3 </td><td>ChTr </td><td>LINEAR </td><td>EGLM</td><td>NO </td><td>[MT10] (**) </td></tr>
</table>
</center><p>(*) Setups are in different coordinates and with different orientation of magnetic field using constrained-transport MHD. (**) second version in sec. 4.7</p>
<p>The snapshot below show the solution for configuration #11.</p>
<p>This setup also works with the <code>BACKGROUND_FIELD</code> spliting. In this case the initial magnetic field is assigned in the <a class="el" href="_m_h_d_2_blast_2init_8c.html#aadd0bb6736fd57811642342df2a86492">BackgroundField()</a> function while the Init() function is used to initialize the deviation to 0.</p>
<div class="image">
<img src="mhd_blast-rho.11.jpg" alt="mhd_blast-rho.11.jpg"/>
<div class="caption">
Density contours at the end of simulation (conf. #11)</div></div>
<div class="image">
<img src="mhd_blast-prs.11.jpg" alt="mhd_blast-prs.11.jpg"/>
<div class="caption">
Pressure contour at the end of simulation (conf. #11)</div></div>
<div class="image">
<img src="mhd_blast-pm.11.jpg" alt="mhd_blast-pm.11.jpg"/>
<div class="caption">
Magnetic pressure contours at the end of simulation (conf. #11)</div></div>
 <dl class="section author"><dt>Authors</dt><dd>A. Mignone (<a href="#" onclick="location.href='mai'+'lto:'+'mig'+'no'+'ne@'+'ph'+'.un'+'it'+'o.i'+'t'; return false;">migno<span style="display: none;">.nosp@m.</span>ne@p<span style="display: none;">.nosp@m.</span>h.uni<span style="display: none;">.nosp@m.</span>to.i<span style="display: none;">.nosp@m.</span>t</a>) </dd></dl>
<dl class="section date"><dt>Date</dt><dd>Sept 24, 2014</dd></dl>
<p><b>References:</b> <br />
</p><ul>
<li>[BS99]: "A Staggered Mesh Algorithm using High Order ...", Balsara &amp; Spicer, JCP (1999) 149, 270 (Sec 3.2)</li>
<li>[GS08]: "An unsplit Godunov method for ideal MHD via constrained 
      transport in three dimensions", Gardiner &amp; Stone, JCP (2008) 227, 4123 (Sec 5.5)</li>
<li>[MT10] "A second-order unsplit Godunov scheme for cell-centered MHD:
     The CTU-GLM scheme", Mignone &amp; Tzeferacos, JCP (2010) 229, 2117 (Sec 4.7)</li>
<li>[Z04]: "A central-constrained transport scheme for ideal 
     magnetohydrodynamics", Ziegler, JCP (2004) 196, 393 (Sec. 4.6) </li>
</ul>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="aadd0bb6736fd57811642342df2a86492"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BackgroundField </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>B0</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Define the component of a static, curl-free background magnetic field. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Aug 31 2015 12:33:07 for PLUTO Test Problems by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.8
</small></address>
</body>
</html>
