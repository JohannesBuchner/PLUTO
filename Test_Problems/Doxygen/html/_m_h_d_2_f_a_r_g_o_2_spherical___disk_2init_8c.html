<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PLUTO Test Problems: /Users/mignone/PLUTO/Test_Problems/MHD/FARGO/Spherical_Disk/init.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">PLUTO Test Problems
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_a9bf029e8facab698e5e604ecb0bd3eb.html">MHD</a></li><li class="navelem"><a class="el" href="dir_955de676c5962b16f2bf5b03992288d8.html">FARGO</a></li><li class="navelem"><a class="el" href="dir_028c2ef22cd8c855a92134997cecd899.html">Spherical_Disk</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">init.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Accretion disk in 3D spherical coordinates.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aec5cba6ad33e98822880b5199543c6e7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_m_h_d_2_f_a_r_g_o_2_spherical___disk_2init_8c.html#aec5cba6ad33e98822880b5199543c6e7">InitDomain</a> (Data *d, Grid *grid)</td></tr>
<tr class="separator:aec5cba6ad33e98822880b5199543c6e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Setup a magnetized disk in 3D spherical coordinates <img class="formulaInl" alt="$(r,\theta,\phi$" src="form_80.png"/>). The disk model is taken form [Flo11],[Mig12] and it consists of an initial equilibrium in a point mass gravity <img class="formulaInl" alt="$ 1/r^2$" src="form_81.png"/> with equilibrium profiles given by </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \rho = \frac{1}{R^{3/2}}\exp\left[\frac{\sin(\theta) - 1}{c_0^2}\right] \,,\qquad p = c_s^2\rho\ ,,\qquad v_\phi = \frac{1}{\sqrt{r}}\left(1 - \frac{5}{2\sin\theta}c_0^2\right) \]" src="form_82.png"/>
</p>
<p> where <img class="formulaInl" alt="$R = r\sin\theta$" src="form_83.png"/> is the cylindrical radius while <img class="formulaInl" alt="$c_0 = H/R$" src="form_84.png"/> and <img class="formulaInl" alt="$c_s = H/R^{3/2}$" src="form_85.png"/> is the sound speed. Here <code>H</code> is the scale height and it is proportional to the cylindrical radius. The constant of proportionality is the ratio <img class="formulaInl" alt="$ H/R $" src="form_86.png"/> defined by the input parameter <code>g_inputParam[H_R]</code>. With the current setting, one rotation period of the inner orbit (<code>r=1</code>) is <img class="formulaInl" alt="$\Delta T = 2\pi$" src="form_87.png"/>.</p>
<p>Differently from [Flo11], a polodial magnetic field is used here, with vector potential prescribed as follows: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ A_\phi = A_0\frac{\sin(2\pi R) - R\cos(2\pi R)}{R} \exp\left[-\left(\frac{z}{H}\right)^4\right] \exp\left[-\left(\frac{R-6}{2}\right)^4\right] \]" src="form_88.png"/>
</p>
<p> where <code>A0</code> is a constant chosen to prescribe a given plasma beta. The exponential terms on the right hand side confine the magnetic field in the midplane around <code>R=6</code>. We also make the vector potential vanish identically for <img class="formulaInl" alt="$ z/H &gt; 2.5$" src="form_89.png"/> or <img class="formulaInl" alt="$ R &lt; 2.5$" src="form_90.png"/>.</p>
<p>The boundary conditions are all set to <code>userdef:</code> </p>
<ul>
<li>at the inner radial boundary, zero-gradient is imposed except for the azimuthal velocity (which is fixed the equilibrium value) and the radial velocity which is zero if velocity is directed inside the domain or copied otherwise (this is referred to as the "diode" b.c.)</li>
<li>at the outer radial boundary we impose zero-gradient except for the azimuthal velocity (fixed to equil. value) and radial velocity which is reflected.</li>
<li>at the vertical (theta) boundaries, ghost zones are filled with the initial equilibrium solution.</li>
</ul>
<p>For the sake of simplicity only a quarter of a disk is considered. This test problems can be run normally or using the FARGO module, giving a saving factor of (roughly) 5. The figure below was produced by running the current setup at twice the resolution and for 90 orbits using FARGO.</p>
<div class="image">
<img src="mhd_spherical_disk.02.png" alt="mhd_spherical_disk.02.png"/>
<div class="caption">
Density map of the disk after 90 innter orbits at twice the resolution.</div></div>
<dl class="section author"><dt>Authors</dt><dd>A. Mignone (<a href="#" onclick="location.href='mai'+'lto:'+'mig'+'no'+'ne@'+'ph'+'.un'+'it'+'o.i'+'t'; return false;">migno<span style="display: none;">.nosp@m.</span>ne@p<span style="display: none;">.nosp@m.</span>h.uni<span style="display: none;">.nosp@m.</span>to.i<span style="display: none;">.nosp@m.</span>t</a>)<br />
</dd></dl>
<dl class="section date"><dt>Date</dt><dd>Aug 16, 2012</dd></dl>
<p><b>References</b> </p><ul>
<li>[Flo11]: "Turbulence and Steady Flows in 3D Global Stratified
     MHD Simulations of Accretion Disks", Flock et al., ApJ (2011), 735:122</li>
<li>[Mig12]: "A Conservative orbital advection scheme for simulations of
     magnetized shear flows with the PLUTO code", Mignone et al, A&amp;A (2012) 545, A152 </li>
</ul>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="aec5cba6ad33e98822880b5199543c6e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aec5cba6ad33e98822880b5199543c6e7">&#9670;&nbsp;</a></span>InitDomain()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void InitDomain </td>
          <td>(</td>
          <td class="paramtype">Data *&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Grid *&#160;</td>
          <td class="paramname"><em>grid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Assign initial condition by looping over the computational domain. Called after the usual <a class="el" href="_particles_2_c_r_2_gyration_2init_8c.html#a8488b38b779097d732c203983f9bb9bf">Init()</a> function to assign initial conditions on primitive variables. Value assigned here will overwrite those prescribed during <a class="el" href="_particles_2_c_r_2_gyration_2init_8c.html#a8488b38b779097d732c203983f9bb9bf">Init()</a>. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Jun 15 2018 22:46:22 for PLUTO Test Problems by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
